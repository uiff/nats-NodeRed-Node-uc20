<script type="text/javascript">
  RED.nodes.registerType('datahub-output', {
    category: 'DataHub-NATS',
    color: '#ff9f43',
    defaults: {
      name: { value: '' },
      connection: { type: 'uos-config', required: true },
      providerId: { value: 'nodered', required: true }
    },
    inputs: 1,
    outputs: 1,
    icon: "white/datahub-output.svg",
    oneditprepare: function() {
      const help = `
      <b>DataHub Output node</b><br>
      <ul>
        <li><b>u-OS Config</b>: select the config node.</li>
        <li><b>Provider ID</b>: defaults to <code>nodered</code> (will be registered automatically).</li>
      </ul>
      Send any JSON payload → nested objects become dot-separated keys (e.g. <code>{ diagnostics: { status_text: 'ok' } }</code> ⇢ <code>diagnostics.status_text</code>).
      `;
      $('#datahub-output-help').html(help);
    },
    label: function () {
      return this.name || `Output ${this.providerId || ''}`;
    },
    labelStyle: function () {
      return this.name ? 'node_label_italic' : '';
    }
  });
</script>

<div class="form-row">
  <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
  <input type="text" id="node-input-name">
</div>
<div class="form-row">
  <label for="node-input-connection"><i class="fa fa-cube"></i> u-OS Config</label>
  <input type="text" id="node-input-connection">
</div>
<div class="form-row">
  <label for="node-input-providerId"><i class="fa fa-id-badge"></i> Provider ID</label>
  <input type="text" id="node-input-providerId" placeholder="nodered">
</div>
<div id="datahub-output-help" class="form-tips"></div>
